<html>

<script>

function removerTR(r) {
  var x = confirm("Deseja realmente excluir este item?");

  if (x){
  var i = r.parentNode.parentNode.rowIndex;
  document.getElementById("myTable").deleteRow(i);
  contaregistros();
      }
  else
    return false;
}

function contaregistros() {
        var totregistros = document.getElementById("tblListaProduto").rows.length-1;

if (totregistros == 0)
{
escondedespesas();
}
else
{
mostratotalgeral();
document.getElementById("totaldespesas").innerHTML = "Despesas: (" + totregistros +")";
}
}
	    
 var indexteste = 0;
    
function adicionarTR(){
        // Quantidade de linha da tabela
        var qtdRows = document.getElementById("tblListaProduto").rows.length;
        var table = document.getElementById("tblListaProduto");
        var newRow = table.insertRow(qtdRows);
        var chave = "composto_" + qtdRows;
        //var indexteste = qtdRows;
        newRow.id = chave;
        
        // add cells to the row
        var cel0 = newRow.insertCell(0);
        var cel1 = newRow.insertCell(1);
        var cel2 = newRow.insertCell(2);
        var cel3 = newRow.insertCell(3);
        var cel4 = newRow.insertCell(4);
        var cel5 = newRow.insertCell(5);

        // add values to the cells
        
//<img src='delete.png' alt='"+i+"' class='btnExcluir'/>

        cel0.innerHTML = "<tr><td><img src='delete.png' value='Delete' onclick='removerTR(this)'></td>";
       // cel0.innerHTML = "<tr><td><img src='edit.png' onclick='pegaindex(this)'/><img src='delete.png' value='Delete' onclick='removerTR(this)'></td>";
       //  cel0.innerHTML = "<input type='button' value='Delete' onclick='removerTR(this)'>";
        cel1.innerHTML = "<td><select name='select' style='border:2px solid #c2cbce; width: 120; background-color:#FFFFFF'> <option value='Alimentacao' selected>Alimentação</option> <option value='Hospedagem'>Hospedagem</option><option value='Pedágio'>Pedagio</option><option value='Combustivel'>Combustível</option><option value='Outras'>Outras</option></select></td>";

       // cel1.innerHTML = "<input type='text' value='" + chave + "'>";
        cel2.innerHTML = "<td><input type='text' style='border:2px solid #c2cbce; width: 400; background-color:#FFFFFF' value='" + "" + "'></td>";
        cel3.innerHTML = "<td><input style='border:2px solid #c2cbce; width: 130; background-color:#FFFFFF' onchange='looptb()' name='valor_unitario[]' class='valor_unitario' type='text' value='" + "0" + "'></td>";
        //cel3.innerHTML = "<td><input onchange='alteroudados()' name='valor_unitario[]' class='valor_unitario' type='text' value='" + qtdRows + "'></td>";
        cel4.innerHTML = "<td><input style='border:2px solid #c2cbce; width: 130; background-color:#FFFFFF' onchange='looptb()' name='qnt[]' class='qnt' type='text' value='" + "1" + "'></td>";

	    //cel5.innerHTML = "<td><input name='total' class='total' readonly='readonly' onclick='calc(0, this)' type='text'></td></tr>";
   	    //cel5.innerHTML = "<td><input name='total' class='total' onclick='calc("+ indexteste +" , this)' value='" + "0" + "' type='text'></td></tr>";
   	    cel5.innerHTML = "<td><input name='total' style='border:2px solid #c2cbce; width: 130; background-color:#FFFFFF; text-align: center' class='total' readonly='readonly' type='text'></td></tr>";
        // cel5.innerHTML = "<td><input id='test2' type='text' value='" + "0" + "'></td><tr>";
        
      
contaregistros();

//calc(indexteste, this);



indexteste = indexteste + 1;

exibedespesas();
looptb();

}



function autsomalinha(){
         //     var vlrunitlinha = document.getElementById(idcat+" + qtdRows+ ").value;
        //    var qtdlinha = document.getElementById("coordenacao12").value;
         //   var totlinha = parseFloat(vlrunitlinha ) * parseFloat(qtdlinha );
         //alert("Despesas: (" + cel3.innerHTML +")");
         //var i = r.parentNode.parentNode.rowIndex;
       //  var i = 100;
        // cel5.innerHTML = "90">";
      
         // alert('Your table has ' + i + ' rows.');
         // alert(document.getElementById("myTable").rows[i].innerHTML);
        // var last = cells[3].innerHTML;
        // alert('Your table has ');
         //document.querySelectorAll("table td:nth-child(6)")[2].innerHTML = "huuhhu"
         //  document.getElementById("totaldespesas").innerHTML = "Despesas: (" + chave +")";
         // alert('Your table has ' + chave + ' rows.');
         
       // var val = document.getElementById("qtdsomar").rows[2].innerHTML;

//cel5.innerHTML = "22";
         //document.getElementById("qtdsomar").innerHTML = "22";
       
//document.getElementById("totaldespesas").innerHTML = "Despesas: (" + val +")";


	var cont = document.getElementById("tblListaProduto").rows.length;
        for (var row = 1; row < cont; row++) 
	{
	

//   $("#tblListaProduto").children().children()[row].children[NumeroDaColunaASerValidada].innerHTML = $("#idDaMinhaTabela").children().children()[row].children[NumeroDaColunaComNovasInformacoes].innerHTML;
//   $("#tblListaProduto").children().children()[row].children[6].innerHTML = 10;
   //document.getElementById("tblListaProduto").children().children()[row].children[4].innerHTML = "22";	  
   alert('Your table has ' + row + ' rows.');	  
             };
}


function autsomalinha2(){

//  var i = r.parentNode.parentNode.rowIndex;
//  document.getElementById("myTable").deleteRow(i);
  
//document.getElementById("test").innerHTML = "test";
document.getElementById("test2").value = 10;
//document.querySelectorAll("table td:nth-child(6)")[2].value = "10";
//alert('AA ' + val + ' AA');
   
}

  function autsomalinha3(element){
    alert("row" + element.parentNode.parentNode.rowIndex + " - column" + element.parentNode.cellIndex);
}


function autsomalinha4(){
var ato = $("#test2").val();
   alert('Your table has ' + ato + ' rows.');
//alert("conteudo da coluna"+2+" ->"+colunas[2].firstChild.nodeValue);
//var to = document.querySelectorAll("table td:nth-child(4)")[1].innerHTML;
//document.querySelectorAll("table td:nth-child(6)")[1].innerText = to;
   
}

function autsomalinha5(){
   // alert("row" + element.parentNode.parentNode.rowIndex);
var tabe = document.body.querySelectorAll("table th:nth-child(2), table td:nth-child(2)");
//var i = r.parentNode.parentNode.rowIndex;
alert('VALOR VAR TO-'+tabe);
  
  }

  var totgeral = 0;
  
function looptb(){

var cont = document.getElementById("tblListaProduto").rows.length-1;
totgeral = 0;
    
for (var row = 0; row < cont; row++) {
    
let valorUnitario = document.getElementsByClassName('valor_unitario')[row].value;
let quantidade = document.getElementsByClassName('qnt')[row].value;
let tt = document.getElementsByClassName('total')[row]

//alert('ANTES PUSH Valor unitario - ' + valorUnitario + ' Quantidade-'+ quantidade)

let total_simple = valorUnitario * quantidade
tt.value = total_simple

totgeral = totgeral+total_simple;

};
//alert('total geral - ' + totgeral + ' AA');
document.getElementById("totgeral").value = totgeral;

if (totgeral > 399)
{
document.getElementById("totgeral").style.color="#FF0000";
}
else
{
document.getElementById("totgeral").style.color="#0000FF";
}


}


function exibecontaregistros() {
var totregistros = document.getElementById("tblListaProduto").rows.length-1;
alert('Variavel totregistros - ' + totregistros+ ' registros');
}

function alteroudados() {
alterou = 1;
//alert('DEFINR Variavel ALTEROU COMO UM - ' + alterou + ' UM');
}

function exibealteroudados() {
alert('SO EXIBE Variavel ALTEROU - ' + alterou + ' valor');
}

function ZERAalterou() {
alterou = 0;
alert('SO EXIBE Variavel ALTEROU - ' + alterou + ' ZERO');
}

let preco = []
let qtd = []
let total = []
var alterou = 0


function calc(indice, self){

alert('COMECOU FUNCAO CALC ANTES IF =' + alterou + ' ?');

if (alterou == 1)
{
let preco = []
let qtd = []
let total = []
alert('COMECOU FUNCAO CALC - VAR ALTEROU =' + alterou + ' UM');
let valorUnitario = document.getElementsByClassName('valor_unitario')[indice]
let quantidade = document.getElementsByClassName('qnt')[indice]
let tt = document.getElementsByClassName('total')[indice]
preco.push(valorUnitario.value)
qtd.push(quantidade.value)
alert('Valor unitario - ' + preco[indice] + ' Quantidade-'+ qtd[indice])	 	
let total_simple = preco[indice] * qtd[indice]
tt.value = total_simple
//alterou = 0
}
else
{
alert('COMECOU FUNCAO CALC - VAR ALTEROU =' + alterou + ' DIFERENTE 1');
let valorUnitario = document.getElementsByClassName('valor_unitario')[indice]
let quantidade = document.getElementsByClassName('qnt')[indice]
let tt = document.getElementsByClassName('total')[indice]
preco.push(valorUnitario.value)
qtd.push(quantidade.value)
alert('Valor unitario - ' + preco[indice] + ' Quantidade-'+ qtd[indice])	 	
let total_simple = preco[indice] * qtd[indice]
tt.value = total_simple

}


}

function calc2(indice, self){

alert('COMECOU FUNCAO CALC 2 - VAR INDICE =' + indice + '');

let valorUnitario = document.getElementsByClassName('valor_unitario')[indice].value;
let quantidade = document.getElementsByClassName('qnt')[indice].value;
let tt = document.getElementsByClassName('total')[indice]

alert('ANTES PUSH Valor unitario - ' + valorUnitario + ' Quantidade-'+ quantidade)

//preco.push(valorUnitario.value)
//qtd.push(quantidade.value)

alert('DEPOIS PUSH Valor unitario - ' + preco[indice] + ' Quantidade-'+ qtd[indice])	 	

let total_simple = valorUnitario * quantidade
tt.value = total_simple

}

function pegaindex(r){
var i = r.parentNode.parentNode.rowIndex;
alert('Resultado Index = ' + i + '');
calc2(i,this);
}

function mostratotalgeral(){
//alert('total geral - ' + totgeral + ' AA');
document.getElementById("totgeral").value = totgeral;
}

function escondedespesas(){
document.getElementById('desp').style.visibility = 'hidden';
}

function exibedespesas(){
document.getElementById('desp').style.visibility = 'visible';
}

</script>


<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 100%;
        color: #040004;
        line-height: 0.4; // ESPAÇO ENTRE LINHAS.
       }

    .content {
        background-color: #FFF;
        width: 80%;

        padding: 20px;
        margin: 0 auto 0 auto;
        box-shadow: 0px 4px 10px;
        border-radius: 5px;
        margin-bottom: 10px;
    }

    .row {
        padding: 5px;
    }
    
    fieldset {
        border-radius: 5px;
        padding: 20px;
        margin-bottom: 10px;
        border-color: #c2cbce;
        box-shadow: 2px 2px 2px #c2cbce;
        background-color: #ECECFF;
    }


    legend {
        font-size: 16px; 
        font-weight: bold;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }

   body {
        background: rgb(2, 0, 36);
        background: linear-gradient(90deg, rgba(2, 0, 36, 1) 0%, rgba(9, 9, 121, 1) 0%, rgba(0, 212, 255, 1) 100%);
    }
    
.botaoincluir{
    background-color: #4CAF50; /* Green */
    border: none;
    color: white;
    padding: 16px 25px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    font-weight: bold;
    margin: 2px 10px;
    -webkit-transition-duration: 0.4s; /* Safari */
    transition-duration: 0.4s;
    cursor: pointer;
    border-radius: 12px;
    width: 200px;
}

.botaoincluir2{
    background-color: #F5F5FF; 
    color: black; 
    border: 2px solid #008CBA;
}

.botaoincluir2:hover {
    background-color: #D2D2FF;
    color: black;
}
    
    legendtitulo {
        font-size: 20px; 
        font-weight: bold;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
    }  

</style>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nova pagina 2</title>
<base target="principal">
</head>

<body>

        <div class="content">
   <!--     <div class="content" style="width: 1024px; height: 445px"> -->
        
      <!--  <p align="center"><b><font size="5">Formulário de solicitação de Reembolso</font></b></p> -->
     
<legendtitulo>
<p align="center" class="legendtitulo" style="margin-bottom: 30px"><i><font color="#000099"><b>Relatório de Despesas</b></font></i></p>
</legendtitulo>


  
  <fieldset>
                <legend> Solicitante: </legend>
           
                    <label for="nome">Nome:</label>
                    <input type="text" id="nome" name="nome" placeholder="Digite seu nome" autocomplete="off" required size="26">
                    <label for="sobrenome">&nbsp; Empresa:</label>
                    <input type="text" id="empresa" name="empresa" placeholder="Digite sua empresa" autocomplete="off" required size="20">
                    <label for="email">&nbsp; E-mail:</label>
                    <input type="email" id="email" name="email" placeholder="Digite seu e-mail" autocomplete="off" required size="28">
                    <label for="area">&nbsp; Área:</label>
                    <input type="text" id="area" name="area" placeholder="Digite sua Área" autocomplete="off" required size="16">
</fieldset>


<p align="right"> 
<button id='textobotaoincluir' onclick="adicionarTR();" class="botaoincluir botaoincluir2">+  Incluir Despesas</button>
</p>  

<fieldset id="desp" style="visibility:hidden">
               
<legend id="totaldespesas"> Despesas: </legend>

<table cellspacing="10" id="myTable" class="table table-bordered">

<thead>

        <tr  class="active">
            <th></th>
            <th width="130" align="left">Categoria</th>
            <th width="270">Descrição</th>
            <th>Valor</th>
            <th>Quantidade</th>
            <th>Total</th>
        </tr>

</thead>

<tbody id="tblListaProduto">


<tr>
</tr>

</tbody>


<tfoot>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>
<input id="totgeral" style="text-align: center; width: 130; font-weight:700" readonly="readonly" class="totgeral" value="0"></td>
</tr>
</tfoot>


</table>


<p align="center"> 
<button id='textobotaoincluir' onClick="window.location.href=window.location.href" class="botaoincluir botaoincluir2">Limpar</button>



<button id='textobotaoincluir' onclick="escondedespesas();" class="botaoincluir botaoincluir2">Cancelar</button>
<button id='textobotaoincluir' onclick="contaregistros();" class="botaoincluir botaoincluir2">Enviar</button>
</p>  


</fieldset>

        
         </div>
   
</body>

</html>
